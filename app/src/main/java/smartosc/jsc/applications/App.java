/*
 * This source file was generated by the Gradle 'init' task
 */
package smartosc.jsc.applications;

import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;

import smartosc.jsc.applications.etl.ba_factory.ExecuterFactory;
import smartosc.jsc.applications.etl.constant.Constants;

public class App {

    public static void main(String[] args) {
        homework1();
        homework2();
    }

    private static void homework1 () {
        String dataset = "[{\"name\": \"AnNM1\", \"gender\": \"Male\"},{\"name\": \"datnt6\", \"gender\": \"Male\"},{\"name\": \"nam\", \"gender\": \"Male\"}]";
        // @TODO The params should be extracted from the request
        String addColumns1 = "[{\"column\": \"email\", \"value\": \"annm1@smartosc.com\"}]";
        String addColumns2 = "[{\"column\": \"age\", \"value\": \"11\"}]";
        String filter1 = "[{\"column\": \"name\", \"operator\": \"contains\", \"value\": \"a\"}]";
        String concat1 = "[{\"newColumnName\": \"nameAge\", \"sourceColumns\": [\"name\", \"age\", \"email\"]}]";
        String renameCol1 = "[{\"currentColumnName\": \"nameAge\", \"newColumnName\": \"nameAgeNew\"}]";
        String removeCol1 = "[\"age\", \"email\"]";
        ObjectMapper mapper = new ObjectMapper();
        try {
            JsonNode jsonDataset = mapper.readTree(dataset);
            // @TODO Factory pattern will be used to create the executer
            JsonNode returnData1 = ExecuterFactory.getExecuter("addColumns").execute(addColumns1, jsonDataset);
            JsonNode returnData2 = ExecuterFactory.getExecuter(Constants.ADD_COLUMNS).execute(addColumns2, returnData1);
            JsonNode returnData3 = ExecuterFactory.getExecuter(Constants.FILTER_COLUMNS).execute(filter1, returnData2);
            JsonNode returnData4 = ExecuterFactory.getExecuter(Constants.CONCAT_COLUMNS).execute(concat1, returnData3);
            JsonNode returnData5 = ExecuterFactory.getExecuter(Constants.RENAME_COLUMNS).execute(renameCol1, returnData4);
            JsonNode returnData6 = ExecuterFactory.getExecuter(Constants.REMOVE_COLUMNS).execute(removeCol1, returnData5);
            String updatedJson = mapper.writerWithDefaultPrettyPrinter().writeValueAsString(returnData6);
            System.out.println(updatedJson);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private static void homework2 () {
        String dataset = "[{\"id\":1,\"sku\":\"EXAM.SKU.01\",\"name\":\"Smart Tivi 4K\",\"price\":120,\"stock\":40,\"category\":\"TIVI\",\"url\":\"https://lg.com/sku/1\",\"country\":\"VN\"},{\"id\":2,\"sku\":\"EXAM.SKU.02\",\"name\":\"Smart Tivi 4K Untra Width\",\"price\":120,\"stock\":40,\"category\":\"TIVI\",\"url\":\"https://lg.com/sku/2\",\"country\":\"VN\"},{\"id\":3,\"sku\":\"EXAM.SKU.03\",\"name\":\"Smart Tivi 2K\",\"price\":120,\"stock\":40,\"category\":\"TIVI\",\"url\":\"https://lg.com/sku/3\",\"country\":\"VN\"},{\"id\":4,\"sku\":\"EXAM.SKU.04\",\"name\":\"Smart Tivi 2K Untra Width\",\"price\":120,\"stock\":40,\"category\":\"TIVI\",\"url\":\"https://lg.com/sku/4\",\"country\":\"VN\"},{\"id\":5,\"sku\":\"EXAM.SKU.05\",\"name\":\"Smart Tivi 8K\",\"price\":120,\"stock\":40,\"category\":\"TIVI\",\"url\":\"https://lg.com/sku/5\",\"country\":\"VN\"},{\"id\":6,\"sku\":\"EXAM.SKU.06\",\"name\":\"Smart Tivi 8K Untra Width\",\"price\":120,\"stock\":40,\"category\":\"TIVI\",\"url\":\"https://lg.com/sku/6\",\"country\":\"VN\"},{\"id\":7,\"sku\":\"EXAM.SKU.07\",\"name\":\"Projector 4K\",\"price\":20,\"stock\":30,\"category\":\"Projector\",\"url\":\"https://lg.com/sku/7\",\"country\":\"VN\"},{\"id\":8,\"sku\":\"EXAM.SKU.08\",\"name\":\"Projector 4K Untra Width\",\"price\":20,\"stock\":30,\"category\":\"Projector\",\"url\":\"https://lg.com/sku/8\",\"country\":\"VN\"},{\"id\":9,\"sku\":\"EXAM.SKU.09\",\"name\":\"Projector 2K\",\"price\":20,\"stock\":30,\"category\":\"Projector\",\"url\":\"https://lg.com/sku/9\",\"country\":\"VN\"},{\"id\":10,\"sku\":\"EXAM.SKU.10\",\"name\":\"Projector 2K Untra Width\",\"price\":20,\"stock\":30,\"category\":\"Projector\",\"url\":\"https://lg.com/sku/10\",\"country\":\"VN\"},{\"id\":11,\"sku\":\"EXAM.SKU.11\",\"name\":\"Projector 8K\",\"price\":20,\"stock\":30,\"category\":\"Projector\",\"url\":\"https://lg.com/sku/11\",\"country\":\"VN\"},{\"id\":12,\"sku\":\"EXAM.SKU.12\",\"name\":\"Projector 8K Untra Width\",\"price\":20,\"stock\":30,\"category\":\"Projector\",\"url\":\"https://lg.com/sku/12\",\"country\":\"VN\"},{\"id\":13,\"sku\":\"EXAM.SKU.13\",\"name\":\"Soundbar Bluetooth A\",\"price\":140,\"stock\":15,\"category\":\"Soundbar\",\"url\":\"https://lg.com/sku/13\",\"country\":\"UK\"},{\"id\":14,\"sku\":\"EXAM.SKU.14\",\"name\":\"Soundbar Bluetooth A\",\"price\":140,\"stock\":15,\"category\":\"Soundbar\",\"url\":\"https://lg.com/sku/14\",\"country\":\"UK\"},{\"id\":15,\"sku\":\"EXAM.SKU.15\",\"name\":\"Soundbar Bluetooth A\",\"price\":140,\"stock\":15,\"category\":\"Soundbar\",\"url\":\"https://lg.com/sku/15\",\"country\":\"UK\"},{\"id\":16,\"sku\":\"EXAM.SKU.16\",\"name\":\"Soundbar Bluetooth A\",\"price\":140,\"stock\":15,\"category\":\"Soundbar\",\"url\":\"https://lg.com/sku/16\",\"country\":\"UK\"},{\"id\":17,\"sku\":\"EXAM.SKU.17\",\"name\":\"Soundbar Bluetooth A\",\"price\":140,\"stock\":15,\"category\":\"Soundbar\",\"url\":\"https://lg.com/sku/17\",\"country\":\"VN\"},{\"id\":18,\"sku\":\"EXAM.SKU.18\",\"name\":\"Soundbar Bluetooth A\",\"price\":140,\"stock\":15,\"category\":\"Soundbar\",\"url\":\"https://lg.com/sku/18\",\"country\":\"VN\"},{\"id\":19,\"sku\":\"EXAM.SKU.19\",\"name\":\"Soundbar Bluetooth A\",\"price\":140,\"stock\":15,\"category\":\"Soundbar\",\"url\":\"https://lg.com/sku/19\",\"country\":\"VN\"},{\"id\":20,\"sku\":\"EXAM.SKU.20\",\"name\":\"Soundbar Bluetooth A\",\"price\":140,\"stock\":15,\"category\":\"Soundbar\",\"url\":\"https://lg.com/sku/20\",\"country\":\"VN\"},{\"id\":21,\"sku\":\"EXAM.SKU.21\",\"name\":\"Soundbar Bluetooth A\",\"price\":140,\"stock\":15,\"category\":\"Soundbar\",\"url\":\"https://lg.com/sku/21\",\"country\":\"VN\"},{\"id\":22,\"sku\":\"EXAM.SKU.22\",\"name\":\"Soundbar Bluetooth A\",\"price\":140,\"stock\":15,\"category\":\"Soundbar\",\"url\":\"https://lg.com/sku/22\",\"country\":\"VN\"}]";
        System.out.println(dataset);
    }
}
